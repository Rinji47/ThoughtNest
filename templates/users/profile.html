{% extends "base.html" %}
{% load static %}

{% block title %}{{ user.username }} - ThoughtNest{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/user_profile.css' %}">
{% endblock %}

{% block content %}
<div class="profile-wrapper">
    <aside class="profile-sidebar">
        <div class="profile-header-section">
            <div class="profile-avatar">
                <i class="fa-solid fa-user"></i>
            </div>
            <h2 class="profile-name">{{ user.get_full_name|default:user.username }}</h2>
            <p class="profile-email">{{ user.email }}</p>
        </div>

        <div class="profile-stats-section">
            <div class="stat-item">
                <span class="stat-number">{{ user_post_count }}</span>
                <span class="stat-label">Posts</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ user_like_count }}</span>
                <span class="stat-label">Likes</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ user_comment_count }}</span>
                <span class="stat-label">Comments</span>
            </div>
        </div>

        <nav class="profile-nav">
            <ul>
                <li><a href="#overview" class="profile-nav-link section-link" data-section="overview">Overview</a></li>
                <li><a href="#posts" class="profile-nav-link section-link" data-section="posts">My Posts</a></li>
                <li><a href="#settings" class="profile-nav-link section-link" data-section="settings">Settings</a></li>
            </ul>
        </nav>
    </aside>

    <main class="profile-content">
        <h1 class="section-title">My Profile</h1>

        {% include 'users/profile_overview.html' %}
        {% include 'users/profile_posts.html' %}
        {% include 'users/profile_settings.html' %}
    </main>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.querySelectorAll('.section-link').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
        const section = this.getAttribute('data-section');
        
        // Remove active class from all sections and links
        document.querySelectorAll('.profile-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.section-link').forEach(l => l.classList.remove('active'));
        
        // Add active class to clicked link
        this.classList.add('active');
        
        // Show the corresponding section
        const sectionEl = document.getElementById(section);
        if (sectionEl) {
            sectionEl.classList.add('active');
            sectionEl.scrollIntoView({ behavior: 'smooth' });
        }
    });
});

// Set overview as active on page load
document.addEventListener('DOMContentLoaded', function() {
    const overviewLink = document.querySelector('[data-section="overview"]');
    if (overviewLink) {
        overviewLink.click();
    }
});
</script>
{% endblock %}
