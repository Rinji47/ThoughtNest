{% extends "base.html" %}
{% load static %}

{% block title %}Manage Comments - Admin{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin.css' %}">
{% endblock %}

{% block content %}
<div class="admin-wrapper">
    {% include 'admin/sidebar.html' %}
    <div class="admin-content">
        <div class="admin-header">
            <h1>Manage Comments</h1>
        </div>

        <div class="comments-management-list">
            {% for comment in comments %}
            <div class="comment-item">
                <div class="comment-content">
                    <strong>
                        {% if comment.author %}
                            {{ comment.author.get_full_name|default:comment.author.username }}
                        {% else %}
                            Guest
                        {% endif %}
                    </strong>
                    <span class="comment-date">{{ comment.created_at|timesince }} ago</span>
                    <p>{{ comment.content }}</p>
                    <small><strong>On:</strong> <a href="{% url 'post_detail' comment.post.pk %}">{{ comment.post.title }}</a></small>
                </div>
                <div class="comment-actions">
                    {% if not comment.approved %}
                    <form method="post" action="/admin/comment/{{ comment.pk }}/approve/" class="admin-form-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn-approve">Approve</button>
                    </form>
                    {% endif %}
                    <form method="post" action="/admin/comment/{{ comment.pk }}/delete/" class="admin-form-inline" onsubmit="return confirm('Delete this comment?');">
                        {% csrf_token %}
                        <button type="submit" class="btn-delete">Delete</button>
                    </form>
                </div>
            </div>
            {% empty %}
            <p class="admin-no-comments">No comments yet.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/admin_dashboard.js' %}"></script>
{% endblock %}
